<h1 class="border-bottom">To Implement a Search Bar</h1>
<% if policy(Property).create? %>
  <%= link_to "Create a Property", new_property_path, class: 'btn btn-dark' %> 
<% end %>
<div class="properties-container">
   <div class="row align-items-top">
        
        <div class="map-container">

      <div id="map"
        style="width: 600px; height: 600px;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key = "pk.eyJ1IjoiZGF2aWRsdWdvMTAiLCJhIjoiY2tsMnBycGFvMGI2ajJucDdzeTc1bmg3diJ9.OIpMWRQo9NRtxDnU52PUmQ">
      </div>

      <ul>
        <% @properties.each do |property| %>
          <div>
            <%= link_to property_path(property) do %>

              <img src="https://source.unsplash.com/random" alt="..." width="300" height="300">
              <li>
                <h2><%= property.title %></h2>
              </li>
              <li>
                <h3>$ <%= property.price %></h3>
              </li>
              <li>
                <p>Address: <%= property.address %></p>
              </li>
              <li>
                <p>Bedrooms: <%= property.bedrooms %></p>
              </li>
              <li>
                <p>Bathrooms: <%= property.bathrooms %></p>
              </li>
              <li>
                <p>sqm: <%= property.sq_meters %></p>
              </li>
              <% if property.favorites.where(user:current_user).count > 0 %>
                <%if policy(Favorite).create? %>
                  <%= link_to "", property_favorites_path(property), method: :post, class:"fas fa-heart" %>
                <%end %>
              <% else %>
                <%if policy(Favorite).create? %>
                  <%= link_to "", property_favorites_path(property), method: :post, class:"far fa-heart", remote: true%>
                <%end %>
              <% end %>
            <%end %>
            

          </div>
        </div>
    
        <div class="card-container">
          <% @properties.each do |property| %>
            <div class="card">
              <%= link_to property_path(property) do %>
                <div class="card-photo">
                  <img , class="card-img-top", src="https://source.unsplash.com/random" alt="Card image cap">
                </div>
                <div class="card-body">
                    <h3>$ <%= property.price %></h3>
                    <div class="property-facts-container">
                      <h5><%= property.bedrooms %> beds </h5>
                      <h5>&nbsp;&nbsp;<%= property.bathrooms %> baths </h5>
                      <h5>&nbsp;&nbsp;<%= property.sq_meters %> sqm </h5>
                    </div>
                    <div class="property-facts-container">
                      <h6><%= property.address %>,</h6>
                      <h6>&nbsp;&nbsp;<%= property.city %></h6>
                      <h6>&nbsp;&nbsp;<%= property.zip_code %></h6>
                    </div>                      
                      <p>Listing Agent(Add path to the listing agent index page): <%= property.user.first_name %></p>
                </div>    
              <%end %>
            </div>
          <% end %>
        </div> 

    </div>

  </div>
</div>
